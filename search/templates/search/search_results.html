{% extends 'base.html' %}
{% load staticfiles %}

{% block page_title %}Search | {{ q }} {% endblock %}

{% block content %}

<!-- check if needed? -->
{% load replace_space %}

<div class="flex-wrapper">

    <!-- Sidebar -->
    {% include 'links/components/sidebar_links.html' %}

    <!-- Content -->
    <div id="content">
        {% include 'top-nav.html' %}

        <!-- messages -->
        {% include 'messages.html' %}

        <div class="container-fluid">
            <div class="row">
                <h3>Your search for '{{ q }}' returned {{ search_results.count }} results</h3>
            </div>
            <div class="row">
                <div class="col-12">
                    <ul class="list-unstyled">
                        {% for result in search_results %}
                        <li id="{{result.position}}_." style="margin: 0.5rem">
                            <a href="{{ result }}" target="_blank" class="bm-link text-decoration-none">
                                <div class="bm-container">
                                    <div class="bm-title">
                                        <span class="bm-title-text">{{ result.title }}</span>
                                        <span class="btn btn-sm btn-outline-secondary bm-options-icon bm-icon-toggle"
                                            role="button">
                                            <i class="fa fa-caret-down" aria-hidden="true"></i>
                                            <small">Options</small">
                                        </span>
                                    </div>
                                </div>
                            </a>
                            <a href="{{ result }}" target="_blank" class="bm-link text-decoration-none">
                                <div class="link-desc text-trunc">{{ result.description }}</div>
                                <div class="link-url text-trunc">{{ result }}</div>
                            </a>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>

            <!-- Pagination -->
            <div class="row">
                <div class="col-12">
                    {% if search_results.has_other_pages %}
                    <h5>Pagination</h5>
                    <ul class="pagination">
                        {% if search_results.has_previous %}
                        <li class="page-item">
                            <a href="?q={{ q }}&rpage={{ search_results.previous_page_number }}" class="page-link">
                                <i class="fa fa-chevron-left" aria-hidden="true"></i>
                            </a>
                        </li>
                        {% else %}
                        <li class="disabled page-item">
                            <span class="page-link">
                                <i class="fa fa-chevron-left" aria-hidden="true"></i>
                            </span>
                        </li>
                        {% endif %}

                        {% for i in search_results.paginator.page_range %}
                        {% if search_results.number == i %}
                        <li class="active page-item" class="active">
                            <span class="page-link">{{ i }}</span>
                        </li>
                        {% else %}
                        <li class="page-item">
                            <a href="?q={{ q }}&rpage={{ i }}" class="page-link">{{ i }}</a>
                        </li>
                        {% endif %}
                        {% endfor %}

                        {% if search_results.has_next %}
                        <li class="page-item">
                            <a href="?q={{ q }}&rpage={{ search_results.next_page_number }}" class="page-link">
                                <i class="fa fa-chevron-right qpage-link" aria-hidden="true"></i>
                            </a>
                        </li>
                        {% else %}
                        <li class="disabled page-item">
                            <span class="page-link">
                                <i class="fa fa-chevron-right" aria-hidden="true"></i>
                            </span>
                        </li>
                        {% endif %}
                    </ul>
                    {% endif %}
                </div>
            </div>


        </div>
        <!-- banner ad -->
        {% include 'advert.html' with advert_path="img/ads/banner.png" %}

    </div>
</div>


{% endblock %}

{% block csrf_js %}
<script src="{% static 'js/csrf.js' %}"></script>
{% endblock %}